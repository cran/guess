<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Gaurav Sood" />

<meta name="date" content="2025-12-15" />

<title>Using guess</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using guess</h1>
<h4 class="author">Gaurav Sood</h4>
<h4 class="date">2025-12-15</h4>



<div id="guess-adjust-estimates-of-learning-for-guessing" class="section level2">
<h2>guess: Adjust Estimates of Learning for Guessing</h2>
<p>Over informative processes, naive estimator of learning—difference
between post and pre process scores—underestimates actual learning. A
heuristic account for why the naive estimator is negatively biased is as
follows: people know as much or more after exposed to an informative
process than before it. And the less people know, the larger the number
of items they don’t know. And greater the opportunity to guess.</p>
<p>Guessing, even when random, only increases the proportion correct.
Thus, bias due to guessing for naive measures of knowledge is always
positive. On average, thus, there is more positive bias in the
pre-process scores than post-process scores. And naturally, subtracting
pre-process scores from post-process provides an attenuated estimate of
actual learning. For a more complete treatment of the issue, read <a href="https://gsood.com/research/papers/guess.pdf">this paper</a> by Ken
Cor and Gaurav Sood.</p>
<p>We provide a few different ways to adjust estimates of learning for
guessing. For now, we limit our attention to cases where the same
battery of knowledge questions has been asked in both the pre- and the
post-process wave. And to cases where closed-ended questions have been
asked. (Guessing is not a serious issue on open-ended items. See more
evidence for that in <a href="https://johnbullock.org/papers/DKs/DK.pdf">DK Means DK</a> by
Robert Luskin and John Bullock.) More generally, the package implements
the methods to adjust learning for guessing discussed in <a href="https://gsood.com/research/papers/guess.pdf">this paper</a>.</p>
<div id="measuring-learning" class="section level3">
<h3>Measuring Learning:</h3>
<div id="estimand" class="section level4">
<h4>Estimand</h4>
<p>Proportion of people who learned a particular piece of information
over the course of an informative process.</p>
</div>
<div id="other-issues" class="section level4">
<h4>Other Issues</h4>
<p>Measurement of knowledge is fundamentally reactive – we must probe to
learn. But probing is not without its problems. For instance, people who
don’t know the answer try to triangulate based on the cues in the
question itself. For another, people are remarkably averse to confessing
to their ignorance. So on a closed ended question, lots of people who
don’t know the right answer, guess. Here are some pertinent issues that
relate to how we analyze the data:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Dealing with Missing Data</strong><br />
If you assume that the data are missing completely at random, you can
simply ignore them. Generally, however, respondents tend to skip items
they don’t know. So missing responses on knowledge questions typically
indicate ignorance. (Of course, it is important to investigate other
potential reasons behind missing data. And we encourage researchers to
take all precautions.) In our treatment, however, for simplicity sake,
we treat missing as indicators of ignorance.</p></li>
<li><p><strong>Dealing with Don’t Knows</strong><br />
We now know a little bit about Don’t Know. One generally strategy is to
treat Don’t Know responses as ignorance. But research suggests that on
average there is approximately 3% hidden knowledge behind Don’t Know
responses. See <a href="https://johnbullock.org/papers/DKs/DK.pdf">DK
Means DK</a> by Robert Luskin and John Bullock. Thus one can also choose
to replace Don’t Know responses with .03.</p></li>
<li><p><strong>Related Knowledge</strong><br />
People either know a particular piece of information or they don’t. On
an open-ended question, they may struggle to remember it but those kinds
of concerns don’t apply to closed-ended questions where the task is
simply to identify the correct answer. What does on occassion happen on
closed-ended questions is that people have related cognitions. So for
instance, asked to identify the prime minister of France, the
respondents sometimes know that one of the options is the king of Sudan
and may guess randomly between the remaining options. But that isn’t the
same as knowing the prime minister of France.</p></li>
</ol>
</div>
<div id="standard-correction-for-guessing" class="section level4">
<h4>Standard Correction for Guessing</h4>
<p>The standard correction for guessing assumes that people guess
randomly. And that people either know or don’t know. Using this
assumption, it then uses total number of incorrect answers to estimate
the total number of items that the person guessed on. For instance, let
us assume there are 4 options on a multiple choice question. Say we have
data from 100 respondents. Say there are 70 incorrect answers and 30
correct. Incorrect answers reflect attempts of guessing. (We also assume
that people aren’t misinformed.) This means we can triangulat the total
number of questions respondents guessed on – 70*(4/3). This means that
the proportion of people who know the piece of information is roughly
.067. Do it for the pre and the post wave and you have estimate of
learning adjusted for guessing using the standard correction.</p>
</div>
<div id="latent-class-correction-for-guessing" class="section level4">
<h4>Latent Class Correction for Guessing</h4>
<p>See the <a href="https://gsood.com/research/papers/guess.pdf">paper</a> for
details.</p>
<hr />
</div>
</div>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>To get the current CRAN version:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;guess&quot;</span>)</span></code></pre></div>
<p>To get the current development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;soodoku/guess&quot;)</span></span></code></pre></div>
</div>
<div id="usage" class="section level3">
<h3>Usage</h3>
<div id="standard-correction-for-guessing-1" class="section level4">
<h4>Standard Correction for Guessing</h4>
<p>To adjust estimates of learning for standard correction of guessing,
use <code>stnd_cor</code>. The function requires takes pre test and post
test data frames containing responses to the items on the pre- and the
post-test, and a <code>lucky</code> vector that contains the probability
of getting an item correct when guessing randomly. Under standard
guessing correction, it is taken to be inverse of total number of
options.</p>
<p><strong>Structure of the Input Data:</strong></p>
<ol style="list-style-type: decimal">
<li>For current purposes, we assume missing responses to indicate
ignorance. Thus functions internally code missing responses as 0.</li>
<li>If the items offer an option to mark <code>Don&#39;t know</code>, code
all <code>Don&#39;t Know</code> responses as ‘d’.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">library</span>(guess)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Generate some data without DK</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">item1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">item2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>pst_test <span class="ot">&lt;-</span> pre_test <span class="sc">+</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>lucky <span class="ot">&lt;-</span> <span class="fu">rep</span>(.<span class="dv">25</span>, <span class="dv">2</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># Unadjusted Effect</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># Treating Don&#39;t Know as ignorance</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">nona</span>(pst_test) <span class="sc">-</span> <span class="fu">nona</span>(pre_test))</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># MCAR</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">colMeans</span>(pst_test <span class="sc">-</span> pre_test, <span class="at">na.rm =</span> T)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co"># Adjusted Effect</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">stnd_cor</span>(pre_test, pst_test, lucky)</span></code></pre></div>
</div>
<div id="transition-matrix" class="section level4">
<h4>Transition Matrix</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Without Don&#39;t Know</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>pre_test_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>) </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>pst_test_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">transmat</span>(pre_test_var, pst_test_var))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># With Don&#39;t Know</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>pre_test_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="cn">NA</span>, <span class="dv">1</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>pst_test_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot;d&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">transmat</span>(pre_test_var, pst_test_var))</span></code></pre></div>
</div>
<div id="adjusting-using-the-latent-class-model" class="section level4">
<h4>Adjusting Using the Latent Class Model</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Create example data for demonstration</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>nitems <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Number of knowledge questions</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>npeople <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Number of respondents</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Generate simulated pre-test and post-test responses (0=incorrect, 1=correct)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nitems, <span class="fu">rbinom</span>(npeople, <span class="dv">1</span>, <span class="fl">0.4</span>))  <span class="co"># 40% correct pre-test</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>post_test <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nitems, <span class="fu">rbinom</span>(npeople, <span class="dv">1</span>, <span class="fl">0.6</span>))  <span class="co"># 60% correct post-test</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>transmatrix <span class="ot">&lt;-</span> <span class="fu">multi_transmat</span>(pre_test, post_test)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lca_cor</span>(transmatrix)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">round</span>(res<span class="sc">$</span>param.lca[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">round</span>(res<span class="sc">$</span>est.learning[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co"># LCA Correction with Don&#39;t Know responses</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co"># Generate data with Don&#39;t Know responses (coded as 2)</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>pre_test_dk <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nitems, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), npeople, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)))</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>post_test_dk <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nitems, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), npeople, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.45</span>, <span class="fl">0.15</span>)))</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>transmatrix <span class="ot">&lt;-</span> <span class="fu">multi_transmat</span>(pre_test_dk, post_test_dk, <span class="at">force9 =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>res_dk <span class="ot">&lt;-</span> <span class="fu">lca_cor</span>(transmatrix)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="fu">round</span>(res_dk<span class="sc">$</span>param.lca[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="fu">round</span>(res_dk<span class="sc">$</span>est.learning[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="adjust-by-groups" class="section level4">
<h4>Adjust by Groups</h4>
<p>Account for propensity to guess and item level attribute that a guess
would be lucky.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>pre_test_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pre=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&#39;d&#39;</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>pst_test_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pst=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="cn">NA</span>, <span class="dv">1</span>, <span class="st">&quot;d&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">&quot;d&quot;</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>grp <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">group_adj</span>(pre_test_var, pst_test_var, <span class="at">gamma =</span> <span class="dv">0</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">group_adj</span>(pre_test_var, pst_test_var, <span class="at">gamma =</span> .<span class="dv">25</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">stnd_cor</span>(pre_test_var, pst_test_var, <span class="at">lucky =</span> .<span class="dv">25</span>)<span class="sc">$</span>learn</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>grp0_raw <span class="ot">&lt;-</span> <span class="fu">group_adj</span>(<span class="fu">subset</span>(pre_test_var, grp <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">subset</span>(pst_test_var, grp <span class="sc">==</span> <span class="dv">0</span>), <span class="at">gamma =</span> <span class="dv">0</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>grp1_raw <span class="ot">&lt;-</span> <span class="fu">group_adj</span>(<span class="fu">subset</span>(pre_test_var, grp <span class="sc">==</span> <span class="dv">1</span>), <span class="fu">subset</span>(pst_test_var, grp <span class="sc">==</span> <span class="dv">1</span>), <span class="at">gamma =</span> <span class="dv">0</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>grp0_adj <span class="ot">&lt;-</span> <span class="fu">group_adj</span>(<span class="fu">subset</span>(pre_test_var, grp <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">subset</span>(pst_test_var, grp <span class="sc">==</span> <span class="dv">0</span>), <span class="at">gamma =</span> .<span class="dv">25</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>grp1_adj <span class="ot">&lt;-</span> <span class="fu">group_adj</span>(<span class="fu">subset</span>(pre_test_var, grp <span class="sc">==</span> <span class="dv">1</span>), <span class="fu">subset</span>(pst_test_var, grp <span class="sc">==</span> <span class="dv">1</span>), <span class="at">gamma =</span> .<span class="dv">25</span>, <span class="at">dk =</span> <span class="dv">0</span>)<span class="sc">$</span>learn</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>grp0_raw <span class="sc">-</span> grp1_raw</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>grp0_adj <span class="sc">-</span> grp1_adj</span></code></pre></div>
</div>
<div id="standard-errors" class="section level4">
<h4>Standard Errors</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Raw </span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Generate some data without DK</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>pre_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">item1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">item2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>pst_test <span class="ot">&lt;-</span> pre_test <span class="sc">+</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>diff <span class="ot">&lt;-</span> pst_test <span class="sc">-</span> pre_test</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>stnd_err <span class="ot">&lt;-</span>  <span class="fu">sapply</span>(diff, <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x, <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(x)))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Bootstrapped s.e.</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># LCA model</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>lca_stnd_err <span class="ot">&lt;-</span> <span class="fu">lca_se</span>(pre_test, post_test, <span class="dv">10</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="fu">sapply</span>(lca_stnd_err, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">head</span>(x, <span class="dv">1</span>), <span class="dv">3</span>))</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>lca_dk_stnd_err <span class="ot">&lt;-</span> <span class="fu">lca_se</span>(pre_test_dk, post_test_dk, <span class="dv">10</span>)</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="fu">sapply</span>(lca_dk_stnd_err, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">head</span>(x, <span class="dv">1</span>), <span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="fit" class="section level4">
<h4>Fit</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fit_nodk</span>(pre_test, post_test, res<span class="sc">$</span>param.lca[<span class="dv">4</span>, ], res<span class="sc">$</span>param.lca[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ])</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">print</span>(fit[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fit_dk</span>(pre_test_dk, post_test_dk, res_dk<span class="sc">$</span>param.lca[<span class="dv">8</span>, ], res_dk<span class="sc">$</span>param.lca[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, ], <span class="at">force9 =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">print</span>(fit[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
